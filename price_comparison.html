<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DLsite & FANZA 価格比較ダッシュボード</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' fill='%2306b6d4'><path d='M32 32C14.3 32 0 46.3 0 64V448c0 17.7 14.3 32 32 32H480c17.7 0 32-14.3 32-32V64c0-17.7-14.3-32-32-32H32zM160 128a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm192 0a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm-96 96a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm-96 96a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm192 0a32 32 0 1 1 0 64 32 32 0 1 1 0-64z'/></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        /* --- Custom Styles --- */
        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #111827; }
        ::-webkit-scrollbar-thumb { background: #374151; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #4b5563; }

        /* Transitions */
        .transition-all { transition: all 0.3s ease-in-out; }
        .transition-transform { transition: transform 0.2s ease-in-out; }
        .transition-colors { transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out, border-color 0.2s ease-in-out; }

        /* Details/Summary animation */
        summary { list-style: none; cursor: pointer; }
        summary::-webkit-details-marker { display: none; }
        details[open] > summary .chevron-icon { transform: rotate(180deg); }

        /* Highlight for best price */
        .result-item-highlight {
            background-color: #166534; /* green-800 */
            color: #f0fdf4; /* green-50 */
        }
        
        /* Registration tab active state */
        .reg-tab-active { color: #fff; }

        /* Animation for newly added items */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .new-item { animation: fadeIn 0.4s ease-in-out; }

        /* Toast Notification */
        #toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .toast {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            border-radius: 8px;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.4s ease-in-out;
        }
        .toast.show {
            opacity: 1;
            transform: translateX(0);
        }
        .toast-success { background-color: #1f2937; border: 1px solid #10b981; color: #d1fae5; }
        .toast-error { background-color: #1f2937; border: 1px solid #ef4444; color: #fee2e2; }
        .toast .icon { margin-right: 10px; }
        
        /* Modal Animation */
        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-20px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        .modal-open { animation: modalFadeIn 0.3s ease-out forwards; }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 font-sans antialiased">

    <div id="loading-overlay" class="fixed inset-0 bg-gray-900 z-[100] flex items-center justify-center p-4">
        <div class="text-center">
            <i class="fas fa-spinner fa-spin fa-3x text-cyan-400"></i>
            <p id="loading-text" class="mt-4 text-gray-400">アプリケーションを初期化中...</p>
        </div>
    </div>

    <div id="login-overlay" class="hidden fixed inset-0 bg-gray-900 bg-opacity-95 z-[90] flex items-center justify-center p-4">
        <div class="w-full max-w-sm">
            <form id="login-form" class="bg-gray-800 p-8 rounded-2xl shadow-2xl space-y-6">
                <h2 class="text-2xl font-bold text-center text-gray-300">価格比較 ログイン</h2>
                <div id="login-error" class="hidden text-sm text-center bg-red-900 border border-red-700 text-red-300 p-2 rounded-lg"></div>
                <div>
                    <label for="login-email" class="block text-sm font-medium text-gray-400 mb-1">メールアドレス</label>
                    <input type="email" id="login-email" required class="w-full bg-gray-700 border border-gray-600 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-sky-500" autocomplete="email">
                </div>
                <div>
                    <label for="login-password" class="block text-sm font-medium text-gray-400 mb-1">パスワード</label>
                    <input type="password" id="login-password" required class="w-full bg-gray-700 border border-gray-600 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-sky-500" autocomplete="current-password">
                </div>
                <button type="submit" class="w-full px-4 py-3 bg-sky-600 hover:bg-sky-700 rounded-lg font-bold text-lg transition-colors">入室</button>
            </form>
        </div>
    </div>

    <!-- Version Display -->
    <div id="version-display" class="fixed top-2 right-3 text-xs text-gray-600 font-mono z-[60]">v4.1 Ad Style Fix</div>

    <!-- Top Ad Banner -->
    <div id="top-ad-banner" class="sticky top-0 z-40 w-full bg-gray-900/80 backdrop-blur-sm border-b border-gray-700/50">
        <div class="max-w-screen-2xl mx-auto p-2 md:px-6 lg:px-8">
            <div id="ad-script-container" class="bg-gray-800/50 rounded-lg text-center flex items-center justify-center min-h-[120px] overflow-hidden">
                <!-- Ad script will be injected here by JS -->
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div id="app-container" class="min-h-screen p-4 md:p-6 lg:p-8 opacity-0 transition-opacity duration-500">
        <div class="max-w-screen-2xl mx-auto grid grid-cols-1 lg:grid-cols-2 gap-8 items-start">

            <!-- Left Column: Controls & Inputs -->
            <aside id="left-aside" class="lg:sticky top-[160px] space-y-8 transition-all duration-300">
                <header class="flex justify-between items-center">
                    <h1 class="text-2xl md:text-3xl font-bold text-cyan-400 flex items-center">
                        <i class="fas fa-balance-scale-right mr-3"></i>
                        価格比較ダッシュボード
                    </h1>
                    <a href="index.html" class="px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors flex items-center text-sm">
                        <i class="fas fa-arrow-left mr-2"></i>
                        セレクターに戻る
                    </a>
                </header>

                <div class="bg-gray-800 p-4 rounded-xl shadow-lg">
                    <h2 class="text-lg font-semibold mb-2 text-cyan-400">ブックマークレット</h2>
                    <p class="text-sm text-gray-400">
                        下の「価格比較に追加」ボタンをブラウザのブックマークバーにドラッグ＆ドロップしてください。
                        <br>
                        作品ページ（DLsiteなど）でブックマークをクリックすると、作品名が登録フォームに自動入力されます。
                    </p>
                    <div class="mt-4 space-y-3">
                        <div class="flex flex-wrap gap-2 items-center">
                            <a id="bookmarklet-link" href="#" class="inline-flex items-center px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white font-bold rounded-lg shadow-lg"
                            title="これをブックマークバーにドラッグ">
                                <i class="fas fa-magic mr-2"></i> 価格比較に追加
                            </a>
                            <span class="text-xs text-gray-500">← これをドラッグ</span>
                        </div>
                        <div class="flex flex-wrap gap-2">
                            <button id="copy-bookmarklet-btn" class="inline-flex items-center px-3 py-1 bg-gray-600 hover:bg-gray-700 text-white text-sm rounded-lg">
                                <i class="fas fa-clipboard mr-2"></i> クリップボードにコピー
                            </button>
                            <button id="show-bookmarklet-btn" class="inline-flex items-center px-3 py-1 bg-gray-600 hover:bg-gray-700 text-white text-sm rounded-lg">
                                <i class="fas fa-code mr-2"></i> コードを表示
                            </button>
                        </div>
                        <p class="text-xs text-gray-500">※ドラッグ＆ドロップが上手くいかない場合は、コードをコピーして手動でブックマークを作成してください。</p>
                    </div>
                </div>
                
                <details class="bg-gray-800 rounded-xl shadow-lg">
                    <summary class="p-5 flex justify-between items-center">
                        <h2 class="text-lg font-bold text-amber-400 flex items-center"><i class="fas fa-info-circle mr-3"></i>使い方</h2>
                        <i class="fas fa-chevron-down chevron-icon transition-transform"></i>
                    </summary>
                    <div class="px-5 pb-5 border-t border-gray-700">
                        <div class="prose prose-invert prose-sm max-w-none text-gray-300 space-y-3 pt-4">
                            <p>1. 「割引登録」「作品登録」で必要な情報を入力します。</p>
                            <p>2. 「比較を実行する」ボタンを押すと、右側に結果が表示されます。</p>
                            <p>3. 右側の結果エリアで割引にチェックを入れたり、作品を既読にしたりすると、合計金額がリアルタイムで更新されます。</p>
                        </div>
                    </div>
                </details>

                <!-- Discount Registration Area -->
                <div class="bg-gray-800 p-6 rounded-xl shadow-lg">
                    <h2 class="text-xl font-bold text-violet-400 mb-4 flex items-center"><i class="fas fa-tags mr-3"></i>割引登録</h2>
                    <div class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <input type="text" id="reg-discount-name" placeholder="割引名 (例: 週末クーポン)" class="w-full bg-gray-700 border border-gray-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-violet-500 transition-colors">
                            <div class="flex items-center gap-4 bg-gray-700 border border-gray-600 rounded-lg px-4 py-2">
                                <label class="block text-sm font-medium">対象サイト:</label>
                                <label class="flex items-center cursor-pointer"><input type="radio" name="reg-discount-site" value="dlsite" checked class="h-4 w-4 text-blue-500 bg-gray-900 border-gray-600 focus:ring-blue-600 ring-offset-gray-800"> <span class="ml-2">DLsite</span></label>
                                <label class="flex items-center cursor-pointer"><input type="radio" name="reg-discount-site" value="fanza" class="h-4 w-4 text-red-500 bg-gray-900 border-gray-600 focus:ring-red-600 ring-offset-gray-800"> <span class="ml-2">FANZA</span></label>
                            </div>
                        </div>
                        <select id="reg-discount-type" class="w-full bg-gray-700 border border-gray-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-violet-500 transition-colors">
                            <option value="bulk">まとめ買い割引</option>
                            <option value="simple_coupon">クーポン (合計金額から)</option>
                            <option value="conditional_coupon">クーポン (条件付き作品)</option>
                            <option value="bulk_coupon">クーポン (複数購入)</option>
                            <option value="per_item">全作品割引 (単価から)</option>
                        </select>
                        <div id="reg-discount-fields" class="p-4 bg-gray-900/50 rounded-lg"></div>
                        <div class="flex justify-end">
                            <button id="add-discount-btn" class="px-6 py-2 bg-violet-600 hover:bg-violet-700 rounded-lg font-semibold transition-colors flex items-center">
                                <i class="fas fa-plus mr-2"></i> 割引を追加
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Work Registration Area -->
                <div class="bg-gray-800 p-6 rounded-xl shadow-lg">
                    <h2 class="text-xl font-bold text-green-400 mb-4 flex items-center"><i class="fas fa-book mr-3"></i>作品登録</h2>
                    <div class="space-y-4">
                        <div class="relative">
                            <input type="text" id="reg-work-name" placeholder="作品名を入力..." class="w-full bg-gray-700 border border-gray-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors">
                            <div id="work-suggestions" class="absolute z-10 w-full bg-gray-600 rounded-b-lg max-h-60 overflow-y-auto mt-1 hidden shadow-lg"></div>
                            <div id="reg-work-status" class="text-xs h-4 mt-1 px-1"></div>
                        </div>

                        <div class="flex border-b border-gray-700">
                            <button id="reg-tab-dlsite" class="reg-tab px-4 py-2 -mb-px border-b-2 font-semibold text-gray-400 border-transparent transition-colors duration-300">DLsite</button>
                            <button id="reg-tab-fanza" class="reg-tab px-4 py-2 -mb-px border-b-2 font-semibold text-gray-400 border-transparent transition-colors duration-300">FANZA</button>
                        </div>
                        
                        <div id="reg-form-dlsite" class="space-y-2">
                            <div class="grid grid-cols-2 gap-4">
                               <input type="number" id="reg-price-dlsite" placeholder="定価" min="0" max="9999999" class="numeric-input w-full bg-gray-700 border border-gray-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 text-right transition-colors">
                               <input type="number" id="reg-discount-dlsite" placeholder="割引(%)" min="0" max="100" class="numeric-input w-full bg-gray-700 border border-gray-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 text-right transition-colors">
                            </div>
                        </div>
                        <div id="reg-form-fanza" class="space-y-2 hidden">
                            <div class="grid grid-cols-2 gap-4">
                               <input type="number" id="reg-price-fanza" placeholder="定価" min="0" max="9999999" class="numeric-input w-full bg-gray-700 border border-gray-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-red-500 text-right transition-colors">
                               <input type="number" id="reg-discount-fanza" placeholder="割引(%)" min="0" max="100" class="numeric-input w-full bg-gray-700 border border-gray-600 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-red-500 text-right transition-colors">
                            </div>
                        </div>
                        
                        <div class="flex justify-end">
                            <button id="add-to-list-btn" class="px-6 py-2 bg-green-600 hover:bg-green-700 rounded-lg font-semibold transition-colors flex items-center">
                                <i class="fas fa-plus mr-2"></i> リストに追加
                            </button>
                        </div>
                    </div>
                </div>

                 <!-- Compare Button -->
                <div class="pt-2">
                    <button id="compare-btn" class="w-full px-8 py-4 bg-cyan-600 hover:bg-cyan-700 rounded-lg font-bold text-xl transition-colors flex items-center justify-center shadow-lg hover:shadow-cyan-500/30">
                        <i class="fas fa-calculator mr-3"></i>
                        比較を実行する
                    </button>
                </div>
            </aside>

            <!-- Right Column: Results & Lists -->
            <main class="space-y-8">
                <!-- Summary -->
                <section id="summary-section" class="bg-gray-800 p-6 rounded-xl shadow-lg">
                    <h2 class="text-xl font-bold mb-4 text-center text-gray-300">最適購入プラン 合計</h2>
                    <div class="bg-green-900 border-2 border-green-700 p-6 rounded-lg text-center w-full max-w-md mx-auto">
                        <p id="optimal-total" class="text-4xl lg:text-5xl font-bold text-green-300 tracking-tight">¥0</p>
                    </div>
                    <div class="grid grid-cols-2 gap-4 mt-6 text-center">
                        <div>
                            <p class="text-sm text-blue-300">DLsite 合計</p>
                            <p id="dlsite-total" class="text-2xl font-bold text-blue-400">¥0</p>
                        </div>
                        <div>
                            <p class="text-sm text-red-300">FANZA 合計</p>
                            <p id="fanza-total" class="text-2xl font-bold text-red-400">¥0</p>
                        </div>
                    </div>
                </section>
                
                <!-- Applied Discounts & Work Lists -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- DLsite Section -->
                    <div class="space-y-6">
                        <section class="bg-gray-800 p-6 rounded-xl shadow-lg">
                            <h3 class="text-lg font-bold text-blue-400 mb-4">適用する割引 (DLsite)</h3>
                            <div id="dlsite-discounts-container" class="space-y-3"><p class="text-sm text-gray-500 discount-placeholder">割引を登録すると表示されます。</p></div>
                        </section>
                        <section class="bg-gray-800 p-6 rounded-xl shadow-lg">
                            <h3 class="text-lg font-bold text-blue-400 mb-4">DLsite 作品リスト</h3>
                            <div id="dlsite-items-container" class="space-y-3"><p class="text-sm text-gray-500 work-placeholder">作品を登録すると表示されます。</p></div>
                        </section>
                    </div>

                    <!-- FANZA Section -->
                    <div class="space-y-6">
                        <section class="bg-gray-800 p-6 rounded-xl shadow-lg">
                            <h3 class="text-lg font-bold text-red-400 mb-4">適用する割引 (FANZA)</h3>
                            <div id="fanza-discounts-container" class="space-y-3"><p class="text-sm text-gray-500 discount-placeholder">割引を登録すると表示されます。</p></div>
                        </section>
                         <section class="bg-gray-800 p-6 rounded-xl shadow-lg">
                            <h3 class="text-lg font-bold text-red-400 mb-4">FANZA 作品リスト</h3>
                            <div id="fanza-items-container" class="space-y-3"><p class="text-sm text-gray-500 work-placeholder">作品を登録すると表示されます。</p></div>
                        </section>
                    </div>
                </div>

                <!-- Detailed Comparison Table -->
                <section>
                    <div class="flex justify-between items-center mb-4 flex-wrap gap-2">
                         <h2 class="text-xl font-bold text-gray-300">詳細比較リスト</h2>
                        <input type="text" id="filter-input" placeholder="リスト内を検索..." class="bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500 transition-colors">
                    </div>
                    <div class="bg-gray-800 rounded-xl shadow-lg overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left">
                                <thead class="bg-gray-700/50 text-xs uppercase tracking-wider">
                                    <tr>
                                        <th class="p-3"><label class="flex items-center"><input type="checkbox" id="toggle-owned-all" class="h-4 w-4 rounded bg-gray-600 text-cyan-500 border-gray-500 focus:ring-cyan-600 mr-2"> 既読</label></th>
                                        <th class="p-3">作品名</th>
                                        <th class="p-3 text-right">DLsite価格</th>
                                        <th class="p-3 text-right">FANZA価格</th>
                                        <th class="p-3 text-center">最安値</th>
                                    </tr>
                                </thead>
                                <tbody id="comparison-table-body">
                                    <tr><td colspan="5" class="p-8 text-center text-gray-500">作品を登録して「比較を実行する」ボタンを押してください。</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>
    
    <!-- Floating Action Buttons -->
    <div class="fixed bottom-6 right-6 z-50 flex flex-col gap-4">
        <button id="debug-fab" class="bg-orange-600 hover:bg-orange-500 w-16 h-16 rounded-full shadow-lg flex items-center justify-center text-2xl transition-transform hover:scale-110">
            <i class="fas fa-bug"></i>
        </button>
        <button id="ad-settings-fab" class="bg-blue-600 hover:bg-blue-500 w-16 h-16 rounded-full shadow-lg flex items-center justify-center text-2xl transition-transform hover:scale-110">
            <i class="fas fa-ad"></i>
        </button>
        <button id="management-tools-fab" class="bg-gray-600 hover:bg-gray-500 w-16 h-16 rounded-full shadow-lg flex items-center justify-center text-2xl transition-transform hover:scale-110">
            <i class="fas fa-tools"></i>
        </button>
    </div>

    <!-- Ad Settings Modal -->
    <div id="ad-settings-modal" class="hidden fixed inset-0 bg-black bg-opacity-70 z-[80] flex items-center justify-center p-4">
        <div id="ad-settings-modal-content" class="bg-gray-800 rounded-xl shadow-lg p-6 max-w-md w-full relative">
             <button id="ad-settings-modal-close" class="absolute top-3 right-3 text-gray-400 hover:text-white transition-colors">
                <i class="fas fa-times fa-lg"></i>
            </button>
            <h3 class="text-xl font-bold mb-6 text-gray-300"><i class="fas fa-ad mr-3"></i>広告設定</h3>
            <div class="space-y-4">
                <div>
                    <label class="flex items-center cursor-pointer">
                        <input type="checkbox" id="ad_visibility" class="h-5 w-5 rounded bg-gray-700 border-gray-600 text-blue-500 focus:ring-blue-600">
                        <span class="ml-3 text-sm font-medium text-gray-300">広告を表示する</span>
                    </label>
                </div>
                <hr class="border-gray-600">
                <div>
                    <label class="block text-sm font-medium text-gray-400 mb-2">表示タイプ</label>
                    <div class="flex gap-4">
                       <label class="flex items-center"><input type="radio" name="ad_type" value="ranking" checked class="h-4 w-4 text-blue-500 bg-gray-700 border-gray-600"> <span class="ml-2">ランキング</span></label>
                       <label class="flex items-center"><input type="radio" name="ad_type" value="new" class="h-4 w-4 text-blue-500 bg-gray-700 border-gray-600"> <span class="ml-2">新着作品</span></label>
                    </div>
                </div>
                <div>
                    <label for="ad_site" class="block text-sm font-medium text-gray-400 mb-1">ジャンル</label>
                    <select id="ad_site" class="w-full bg-gray-700 border border-gray-600 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="maniax">同人</option>
                        <option value="pro">美少女ゲーム</option>
                        <option value="books">成年コミック</option>
                        <option value="appx">スマホゲーム</option>
                    </select>
                </div>
                <div id="ad-period-container">
                    <label for="ad_period" class="block text-sm font-medium text-gray-400 mb-1">期間 (ランキング)</label>
                    <select id="ad_period" class="w-full bg-gray-700 border border-gray-600 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="24h">24時間ランキング</option>
                        <option value="week">7日間ランキング</option>
                        <option value="month">1ヵ月間ランキング</option>
                        <option value="year">当年ランキング</option>
                        <option value="total">累計ランキング</option>
                    </select>
                </div>
                <div class="flex justify-end pt-4">
                    <button id="save-ad-settings-btn" class="px-6 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg font-semibold transition-colors">
                        設定を保存
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Management Modal -->
    <div id="management-modal" class="hidden fixed inset-0 bg-black bg-opacity-70 z-[80] flex items-center justify-center p-4">
        <div id="management-modal-content" class="bg-gray-800 rounded-xl shadow-lg p-6 max-w-md w-full relative">
            <button id="management-modal-close" class="absolute top-3 right-3 text-gray-400 hover:text-white transition-colors">
                <i class="fas fa-times fa-lg"></i>
            </button>
            <h3 class="text-xl font-bold mb-6 text-gray-300"><i class="fas fa-tools mr-3"></i>管理ツール</h3>
            <div class="space-y-4">
                <p class="text-sm text-gray-400">各リストの内容をリセットします。この操作は元に戻せません。</p>
                <button id="modal-reset-dlsite-btn" class="w-full px-4 py-3 bg-red-800 hover:bg-red-700 rounded-lg text-sm transition-colors text-left flex items-center">
                    <i class="fas fa-trash-alt mr-3 w-4"></i>
                    <span>DLsiteの作品と割引をリセット</span>
                </button>
                <button id="modal-reset-fanza-btn" class="w-full px-4 py-3 bg-red-800 hover:bg-red-700 rounded-lg text-sm transition-colors text-left flex items-center">
                    <i class="fas fa-trash-alt mr-3 w-4"></i>
                    <span>FANZAの作品と割引をリセット</span>
                </button>
                <button id="modal-reset-all-btn" class="w-full px-4 py-3 bg-red-600 hover:bg-red-500 rounded-lg font-semibold transition-colors flex items-center">
                    <i class="fas fa-exclamation-triangle mr-3 w-4"></i>
                    <span>すべての作品と割引をリセット</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirm-modal" class="hidden fixed inset-0 bg-black bg-opacity-70 z-[90] flex items-center justify-center p-4">
        <div id="confirm-modal-content" class="bg-gray-800 rounded-xl shadow-lg p-6 max-w-sm w-full">
            <h3 id="confirm-title" class="text-lg font-bold mb-4">確認</h3>
            <p id="confirm-message" class="text-gray-300 mb-6">この操作を続けてもよろしいですか？</p>
            <div class="flex justify-end space-x-4">
                <button id="confirm-cancel" class="px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded-lg transition-colors">キャンセル</button>
                <button id="confirm-ok" class="px-4 py-2 bg-red-600 hover:bg-red-500 rounded-lg font-semibold transition-colors">OK</button>
            </div>
        </div>
    </div>

    <div id="bookmarklet-code-modal" class="hidden fixed inset-0 bg-black bg-opacity-70 z-[80] flex items-center justify-center p-4">
        <div id="bookmarklet-code-modal-content" class="bg-gray-800 rounded-xl shadow-lg p-6 max-w-lg w-full relative">
            <button id="bookmarklet-code-modal-close" class="absolute top-3 right-3 text-gray-400 hover:text-white transition-colors">
                <i class="fas fa-times fa-lg"></i>
            </button>
            <h3 class="text-xl font-bold mb-6 text-gray-300"><i class="fas fa-code mr-3"></i>ブックマークレット コード</h3>
            <p class="text-sm text-gray-400 mb-2">以下のコードをすべてコピーして、ブックマークのURL欄に貼り付けてください。</p>
            <textarea id="bookmarklet-code-display" readonly class="w-full h-40 bg-gray-900 text-gray-300 font-mono text-xs p-2 rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-cyan-500"></textarea>
        </div>
    </div>


    <div id="debug-modal" class="hidden fixed inset-0 bg-black bg-opacity-70 z-[80] flex items-center justify-center p-4">
        <div id="debug-modal-content" class="bg-gray-800 rounded-xl shadow-lg p-6 max-w-lg w-full relative">
            <button id="debug-modal-close" class="absolute top-3 right-3 text-gray-400 hover:text-white transition-colors">
                <i class="fas fa-times fa-lg"></i>
            </button>
            <h3 class="text-xl font-bold mb-6 text-orange-400"><i class="fas fa-bug mr-3"></i>デバッグ情報</h3>
            <div id="debug-modal-display" class="space-y-2 text-sm text-gray-300 bg-gray-900 p-4 rounded-lg font-mono max-h-[60vh] overflow-y-auto">
                </div>
        </div>
    </div>

    <!-- Toast Notification Container -->
    <div id="toast-container"></div>

    
    
    <script type="module" src="price_comparison_logic.js"></script>
</body>
</html>
